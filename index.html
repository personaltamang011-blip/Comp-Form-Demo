<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computer Parts Form</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}
body{min-height:100vh;display:flex;justify-content:center;align-items:center;background:linear-gradient(135deg,#74ebd5,#ACB6E5);transition:background 0.3s}
.form-container{background:#fff;padding:30px 40px;border-radius:15px;box-shadow:0 4px 20px rgba(0,0,0,0.15);width:100%;max-width:420px}
.form-container h2{text-align:center;color:#333;margin-bottom:20px}
.form-group{position:relative;margin-bottom:20px}
.form-group input,.form-group select{width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;font-size:16px;outline:none;background:transparent}
.form-group label{position:absolute;top:50%;left:12px;transform:translateY(-50%);color:#666;font-size:16px;pointer-events:none;transition:0.3s ease all;background:#fff;padding:0 5px}
.form-group input:focus + label,.form-group input:not(:placeholder-shown) + label,.form-group select:focus + label,.form-group select:not([value=""]) + label{top:0;font-size:13px;color:#149b6393}


button{width:100%;padding:12px;background-color:#585f66;color:white;border:none;border-radius:8px;cursor:pointer;font-size:16px}
button:hover{background-color:#248363}
body.dark{background:linear-gradient(135deg,#232526,#414345)}
body.dark .form-container{background:#2c2c2c;color:#f5f5f5}
body.dark input,body.dark select{border:1px solid #555;color:#fff}
body.dark label{background:#2c2c2c;color:#bbb}
body.dark button{background:#ff9800;color:#000}
.toggle-mode{margin-top:15px;text-align:center;cursor:pointer;font-size:14px;color:#758a9b}
body.dark .toggle-mode{color:#ff9800}
</style>
</head>
<body>

<div class="form-container">
<h2>Computer Parts Entry</h2>

<form name="contact-form">

<!-- ‚úÖ New Date Input (Optional, Typable Nepali Date) -->
<div class="form-group">
  <input type="text" name="date" placeholder=" ">
  <label>Date (Nepali)</label>
</div>

<div class="form-group">
<select name="category" id="category" required>
<option value="" disabled selected></option>
</select>
<label>Category</label>
</div>

<div class="form-group">
<select name="brand" id="brand" required>
<option value="" disabled selected></option>
</select>
<label>Brand</label>
</div>

<div class="form-group">
<select name="model" id="model" required>
<option value="" disabled selected></option>
</select>
<label>Model</label>
</div>

<div class="form-group">
<input type="number" name="quantity" placeholder=" " required>
<label>Quantity</label>
</div>

<div class="form-group">
<input type="number" name="price" placeholder=" " required id="priceInput">
<label>Price</label>
</div>

<button type="submit">Submit</button>
</form>

<div class="toggle-mode" id="toggleMode">üåô Switch to Dark Mode</div>
</div>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbxjoTZMaxtqgITeTnktuODWfUFXgchfytszx2x19PhKkhA21IuRyKfFk2Pd_UZ6hb_c/exec';

const jsonFiles = ["data.computer.json", "data.organization.json"];
let combinedData = {};

const categorySel = document.getElementById("category");
const brandSel = document.getElementById("brand");
const modelSel = document.getElementById("model");
const priceInput = document.getElementById("priceInput");

async function loadData() {
  try {
    for (const file of jsonFiles) {
      const res = await fetch(file);
      if (!res.ok) throw `Failed to load ${file}`;
      const data = await res.json();
      combinedData = { ...combinedData, ...data };
    }

    categorySel.innerHTML =
      `<option value="" disabled selected>Select Category</option>`;

    Object.keys(combinedData).forEach(cat => {
      categorySel.innerHTML +=
        `<option value="${cat}">${cat}</option>`;
    });

  } catch (err) {
    alert("‚ùå Data file not loaded. Check JSON file name & location.");
    console.error(err);
  }
}

loadData();

/* CATEGORY ‚Üí BRAND */
categorySel.onchange = () => {
  brandSel.innerHTML =
    `<option value="" disabled selected>Select Brand</option>`;
  modelSel.innerHTML =
    `<option value="" disabled selected>Select Model</option>`;
  priceInput.value = "";

  Object.keys(combinedData[categorySel.value]).forEach(brand => {
    brandSel.innerHTML +=
      `<option value="${brand}">${brand}</option>`;
  });
};

/* BRAND ‚Üí MODEL */
brandSel.onchange = () => {
  modelSel.innerHTML =
    `<option value="" disabled selected>Select Model</option>`;
  priceInput.value = "";

  combinedData[categorySel.value][brandSel.value].forEach(item => {
    modelSel.innerHTML +=
      `<option value="${item.model}" data-price="${item.price}">
        ${item.model}
      </option>`;
  });
};

/* MODEL ‚Üí PRICE */
modelSel.onchange = () => {
  const opt = modelSel.options[modelSel.selectedIndex];
  priceInput.value = opt.dataset.price || "";
};

// Submit to Google Sheets
const form = document.forms['contact-form'];
form.addEventListener('submit', e=>{
    e.preventDefault();
    fetch(scriptURL,{method:'POST', body:new FormData(form)})
    .then(()=>alert("‚úÖ Submitted to Google Sheet"))
    .then(()=>form.reset())
    .catch(err=>console.error(err));
});

// Dark mode toggle
const toggleBtn = document.getElementById('toggleMode');
toggleBtn.addEventListener('click',()=>{
    document.body.classList.toggle('dark');
    toggleBtn.textContent = document.body.classList.contains('dark')
        ? '‚òÄÔ∏è Switch to Light Mode'
        : 'üåô Switch to Dark Mode';
});
</script>

</body>
</html>
